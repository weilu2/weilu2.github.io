<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Pandas Tutorial | 全宇宙尖端技术研究基地</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="摘要Pandas 是 Python 语言下的一个用于数据分析的工具类库。使用 Pandas 可以方便的对数据进行处理和分析。">
<meta name="keywords" content="Pandas,Data Analysis,Series,DataFrame">
<meta property="og:type" content="article">
<meta property="og:title" content="Pandas Tutorial">
<meta property="og:url" content="http://yoursite.com/2018/11/29/Pandas-Tutorial/index.html">
<meta property="og:site_name" content="全宇宙尖端技术研究基地">
<meta property="og:description" content="摘要Pandas 是 Python 语言下的一个用于数据分析的工具类库。使用 Pandas 可以方便的对数据进行处理和分析。">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-11-29T15:24:11.001Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pandas Tutorial">
<meta name="twitter:description" content="摘要Pandas 是 Python 语言下的一个用于数据分析的工具类库。使用 Pandas 可以方便的对数据进行处理和分析。">
  
    <link rel="alternate" href="/atom.xml" title="全宇宙尖端技术研究基地" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">全宇宙尖端技术研究基地</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">专门研究各种全宇宙高精尖技术，比如“各种版本的Hello World怎么写”、“各种版本操作系统如何开机关机”、“如何喂养一只卖不出去的布偶猫”等...</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Pandas-Tutorial" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/29/Pandas-Tutorial/" class="article-date">
  <time datetime="2018-11-29T15:21:24.000Z" itemprop="datePublished">2018-11-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python/">Python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Pandas Tutorial
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h1><p>Pandas 是 Python 语言下的一个用于数据分析的工具类库。使用 Pandas 可以方便的对数据进行处理和分析。</p>
<a id="more"></a>
<h1 id="1-Data-Structures"><a href="#1-Data-Structures" class="headerlink" title="1. Data Structures"></a>1. Data Structures</h1><p>Pandas 处理数据靠的是两个核心数据结构，Series 和 DataFrame，将会贯穿于整个数据分析过程。</p>
<p>Series 用来处理一维的序列数据，而 DataFrame 用来处理更复杂的多维数据。</p>
<h2 id="1-1-Series"><a href="#1-1-Series" class="headerlink" title="1.1. Series"></a>1.1. Series</h2><p>Series 是 Pandas 中用来处理一维数据的结构，有点类似于数组，但是增加了许多额外的特性。其数据结构如下所示：</p>
<table>
<thead>
<tr>
<th style="text-align:center">index</th>
<th style="text-align:center">value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">12</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">-4</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">7</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">9</td>
</tr>
</tbody>
</table>
<p>Series 包含两个数组，一个是存储的实际的值，另一个存储的是值的索引。Series 中存储的值可以是所有的 NumPy 中的数据结构。</p>
<h3 id="1-1-1-创建-Series"><a href="#1-1-1-创建-Series" class="headerlink" title="1.1.1. 创建 Series"></a>1.1.1. 创建 Series</h3><h4 id="1-1-1-1-从-list-中创建"><a href="#1-1-1-1-从-list-中创建" class="headerlink" title="1.1.1.1. 从 list 中创建"></a>1.1.1.1. 从 list 中创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="number">12</span>, <span class="number">-4</span>, <span class="number">7</span>, <span class="number">9</span>])</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>    <span class="number">12</span></span><br><span class="line"><span class="number">1</span>    <span class="number">-4</span></span><br><span class="line"><span class="number">2</span>     <span class="number">7</span></span><br><span class="line"><span class="number">3</span>     <span class="number">9</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h4 id="1-1-1-2-创建指定索引的-Series"><a href="#1-1-1-2-创建指定索引的-Series" class="headerlink" title="1.1.1.2. 创建指定索引的 Series"></a>1.1.1.2. 创建指定索引的 Series</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="number">12</span>, <span class="number">-4</span>, <span class="number">7</span>, <span class="number">9</span>], index = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>])</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a    <span class="number">12</span></span><br><span class="line">b    <span class="number">-4</span></span><br><span class="line">c     <span class="number">7</span></span><br><span class="line">d     <span class="number">9</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h4 id="1-1-1-3-从-Numpy-数组创建"><a href="#1-1-1-3-从-Numpy-数组创建" class="headerlink" title="1.1.1.3. 从 Numpy 数组创建"></a>1.1.1.3. 从 Numpy 数组创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">ser = pd.Series(arr)</span><br><span class="line">print(ser)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>    <span class="number">1</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3</span></span><br><span class="line"><span class="number">3</span>    <span class="number">4</span></span><br><span class="line">dtype: int32</span><br></pre></td></tr></table></figure>
<p><strong>需要注意的是，从 Numpy 中创建的 Series，只是引用，对 Series 中值操作的影响会直接反应到原始的 Numpy 中</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(arr)</span><br><span class="line">ser[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">print(arr)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span>]</span><br><span class="line">[<span class="number">0</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span>]</span><br></pre></td></tr></table></figure>
<h4 id="1-1-1-4-从-dict-创建"><a href="#1-1-1-4-从-dict-创建" class="headerlink" title="1.1.1.4. 从 dict 创建"></a>1.1.1.4. 从 dict 创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;<span class="string">'red'</span>: <span class="number">2000</span>, <span class="string">'blue'</span>: <span class="number">1000</span>, <span class="string">'yellow'</span>: <span class="number">500</span>, <span class="string">'orange'</span>: <span class="number">1000</span>&#125;</span><br><span class="line">ser = pd.Series(dic)</span><br><span class="line">print(ser)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">red       <span class="number">2000</span></span><br><span class="line">blue      <span class="number">1000</span></span><br><span class="line">yellow     <span class="number">500</span></span><br><span class="line">orange    <span class="number">1000</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="1-1-2-查看-Series"><a href="#1-1-2-查看-Series" class="headerlink" title="1.1.2. 查看 Series"></a>1.1.2. 查看 Series</h3><h4 id="1-1-2-1-访问元素-amp-查看Series"><a href="#1-1-2-1-访问元素-amp-查看Series" class="headerlink" title="1.1.2.1. 访问元素&amp;查看Series"></a>1.1.2.1. 访问元素&amp;查看Series</h4><p>使用指定标签创建的 Series 既可以用下标访问元素，也可以用标签访问元素：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"s[1]: "</span> + str(s[<span class="number">1</span>]))</span><br><span class="line">print(<span class="string">"s['b']: "</span> + str(s[<span class="string">'b'</span>]))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="number">1</span>]: <span class="number">-4</span></span><br><span class="line">s[<span class="string">'b'</span>]: <span class="number">-4</span></span><br></pre></td></tr></table></figure>
<p>另外还可以直接查看 Series 的索引和值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"s.values: "</span> + str(s.values))</span><br><span class="line">print(<span class="string">"s.index: "</span> + str(s.index))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s.values: [<span class="number">12</span> <span class="number">-4</span>  <span class="number">7</span>  <span class="number">9</span>]</span><br><span class="line">s.index: Index([<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>], dtype=<span class="string">'object'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="1-1-2-2-选取值"><a href="#1-1-2-2-选取值" class="headerlink" title="1.1.2.2. 选取值"></a>1.1.2.2. 选取值</h3><p>从 Series 中选取值与 NumPy 中类似，可以直接使用切片的方式选取。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(s[<span class="number">0</span>:<span class="number">2</span>])</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a    <span class="number">12</span></span><br><span class="line">b    <span class="number">-4</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>另外 Series 还支持使用标签的形式来选取对应的值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(s[[<span class="string">'b'</span>, <span class="string">'d'</span>]])</span><br></pre></td></tr></table></figure>
<p>注意，这里的标签是一个数组，打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b   <span class="number">-4</span></span><br><span class="line">d    <span class="number">9</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>使用表达式选择值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(s[s &gt; <span class="number">8</span>])</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a    <span class="number">12</span></span><br><span class="line">d     <span class="number">9</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="1-1-2-3-赋值"><a href="#1-1-2-3-赋值" class="headerlink" title="1.1.2.3. 赋值"></a>1.1.2.3. 赋值</h3><p>可以直接使用标签或索引，类似于数组进行赋值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="string">'b'</span>] = <span class="number">1</span></span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a    <span class="number">12</span></span><br><span class="line">b     <span class="number">1</span></span><br><span class="line">c     <span class="number">7</span></span><br><span class="line">d     <span class="number">9</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="1-1-3-数学运算"><a href="#1-1-3-数学运算" class="headerlink" title="1.1.3. 数学运算"></a>1.1.3. 数学运算</h3><p>类似于 Numpy 中对数学运算的支持，可以使用 Series 直接与数值进行加减乘除。</p>
<h3 id="1-1-4-常用操作"><a href="#1-1-4-常用操作" class="headerlink" title="1.1.4. 常用操作"></a>1.1.4. 常用操作</h3><h4 id="1-1-4-1-去重"><a href="#1-1-4-1-去重" class="headerlink" title="1.1.4.1. 去重"></a>1.1.4.1. 去重</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser = pd.Series([<span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">print(ser.unique())</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<h4 id="1-1-4-2-统计"><a href="#1-1-4-2-统计" class="headerlink" title="1.1.4.2. 统计"></a>1.1.4.2. 统计</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser = pd.Series([<span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">print(ser.value_counts())</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>    <span class="number">2</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">3</span>    <span class="number">1</span></span><br><span class="line"><span class="number">0</span>    <span class="number">1</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>其中第一列表示的是 Series 中的值，第二列表示的是在 Series 中出现的次数。</p>
<h4 id="1-1-4-3-是否存在"><a href="#1-1-4-3-是否存在" class="headerlink" title="1.1.4.3. 是否存在"></a>1.1.4.3. 是否存在</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser = pd.Series([<span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">print(ser.isin([<span class="number">0</span>, <span class="number">3</span>]))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">1</span>     <span class="keyword">True</span></span><br><span class="line"><span class="number">2</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">3</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">4</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">5</span>     <span class="keyword">True</span></span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure>
<p>直接将结果返回回来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(ser[ser.isin([<span class="number">0</span>, <span class="number">3</span>])])</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>    <span class="number">0</span></span><br><span class="line"><span class="number">5</span>    <span class="number">3</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h4 id="1-1-4-4-空值"><a href="#1-1-4-4-空值" class="headerlink" title="1.1.4.4. 空值"></a>1.1.4.4. 空值</h4><p>在 Pandas 中使用 Numpy 中的 NaN 表示空值。可以使用 <code>isnull()</code> 和 <code>notnull()</code> 方法筛选结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ser = pd.Series([<span class="number">5</span>, <span class="number">-3</span>, np.NaN, <span class="number">15</span>])</span><br><span class="line">print(ser)</span><br><span class="line"></span><br><span class="line">print(ser.isnull())</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>     <span class="number">5.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">-3.0</span></span><br><span class="line"><span class="number">2</span>     NaN</span><br><span class="line"><span class="number">3</span>    <span class="number">15.0</span></span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line"><span class="number">0</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">1</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">2</span>     <span class="keyword">True</span></span><br><span class="line"><span class="number">3</span>    <span class="keyword">False</span></span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure>
<h2 id="1-2-DataFrame"><a href="#1-2-DataFrame" class="headerlink" title="1.2. DataFrame"></a>1.2. DataFrame</h2><p>DataFrame 是一种类似于表格的结构，用于处理多维数据。</p>
<table>
<thead>
<tr>
<th style="text-align:center">index</th>
<th style="text-align:center">color</th>
<th style="text-align:center">object</th>
<th style="text-align:center">price</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">blue</td>
<td style="text-align:center">ball</td>
<td style="text-align:center">1.2</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">green</td>
<td style="text-align:center">pen</td>
<td style="text-align:center">1.0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">yellow</td>
<td style="text-align:center">pencil</td>
<td style="text-align:center">0.5</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">red</td>
<td style="text-align:center">paper</td>
<td style="text-align:center">0.8</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">white</td>
<td style="text-align:center">mug</td>
<td style="text-align:center">1.5</td>
</tr>
</tbody>
</table>
<p>不同于 Series，DataFrame 有两列索引，第一个索引是行索引，每个索引关联一行的数据；第二个索引包含的是一系列的标签，关联的是每个特定的列。</p>
<p>我们一般把行索引称为索引（index），把列索引称为标签（label）。</p>
<h3 id="1-2-1-创建-DataFrame"><a href="#1-2-1-创建-DataFrame" class="headerlink" title="1.2.1. 创建 DataFrame"></a>1.2.1. 创建 DataFrame</h3><h4 id="1-2-1-1-从字典中创建"><a href="#1-2-1-1-从字典中创建" class="headerlink" title="1.2.1.1. 从字典中创建"></a>1.2.1.1. 从字典中创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">myDict = &#123;</span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'blue'</span>, <span class="string">'green'</span>, <span class="string">'yellow'</span>, <span class="string">'red'</span>, <span class="string">'white'</span>],</span><br><span class="line">	<span class="string">'object'</span>: [<span class="string">'ball'</span>, <span class="string">'pen'</span>, <span class="string">'pencil'</span>, <span class="string">'paper'</span>, <span class="string">'mug'</span>],</span><br><span class="line">	<span class="string">'price'</span>: [<span class="number">1.2</span>, <span class="number">1.0</span>, <span class="number">0.5</span>, <span class="number">0.8</span>, <span class="number">1.5</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    color  object  price</span><br><span class="line"><span class="number">0</span>    blue    ball    <span class="number">1.2</span></span><br><span class="line"><span class="number">1</span>   green     pen    <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>  yellow  pencil    <span class="number">0.5</span></span><br><span class="line"><span class="number">3</span>     red   paper    <span class="number">0.8</span></span><br><span class="line"><span class="number">4</span>   white     mug    <span class="number">1.5</span></span><br></pre></td></tr></table></figure>
<p>在创建时还可以指定需要的列，以及指定索引。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(myDict, columns=[<span class="string">'object'</span>,<span class="string">'price'</span>],</span><br><span class="line">	index=[<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>,<span class="string">'four'</span>,<span class="string">'five'</span>])</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">       object  price</span><br><span class="line">one      ball    <span class="number">1.2</span></span><br><span class="line">two       pen    <span class="number">1.0</span></span><br><span class="line">three  pencil    <span class="number">0.5</span></span><br><span class="line">four    paper    <span class="number">0.8</span></span><br><span class="line">five      mug    <span class="number">1.5</span></span><br></pre></td></tr></table></figure>
<h4 id="1-2-1-2-从-Numpy-数组中创建"><a href="#1-2-1-2-从-Numpy-数组中创建" class="headerlink" title="1.2.1.2. 从 Numpy 数组中创建"></a>1.2.1.2. 从 Numpy 数组中创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr = np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>, <span class="number">4</span>))</span><br><span class="line">df = pd.DataFrame(arr, columns=[<span class="string">'colA'</span>,<span class="string">'colB'</span>, <span class="string">'colC'</span>, <span class="string">'colD'</span>])</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   colA  colB  colC  colD</span><br><span class="line"><span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span>     <span class="number">2</span>     <span class="number">3</span></span><br><span class="line"><span class="number">1</span>     <span class="number">4</span>     <span class="number">5</span>     <span class="number">6</span>     <span class="number">7</span></span><br><span class="line"><span class="number">2</span>     <span class="number">8</span>     <span class="number">9</span>    <span class="number">10</span>    <span class="number">11</span></span><br><span class="line"><span class="number">3</span>    <span class="number">12</span>    <span class="number">13</span>    <span class="number">14</span>    <span class="number">15</span></span><br></pre></td></tr></table></figure>
<h3 id="1-2-2-查看-DataFrame"><a href="#1-2-2-查看-DataFrame" class="headerlink" title="1.2.2. 查看 DataFrame"></a>1.2.2. 查看 DataFrame</h3><h4 id="1-2-2-1-基本信息"><a href="#1-2-2-1-基本信息" class="headerlink" title="1.2.2.1. 基本信息"></a>1.2.2.1. 基本信息</h4><p>查看索引：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(df.index)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RangeIndex(start=<span class="number">0</span>, stop=<span class="number">4</span>, step=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>查看标签：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(df.columns)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Index([<span class="string">'colA'</span>, <span class="string">'colB'</span>, <span class="string">'colC'</span>, <span class="string">'colD'</span>], dtype=<span class="string">'object'</span>)</span><br></pre></td></tr></table></figure>
<p>查看值：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.values</span><br></pre></td></tr></table></figure></p>
<h4 id="1-2-2-2-选择列"><a href="#1-2-2-2-选择列" class="headerlink" title="1.2.2.2. 选择列"></a>1.2.2.2. 选择列</h4><p>使用标签选择对应列的值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">myDict = &#123;</span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'blue'</span>, <span class="string">'green'</span>, <span class="string">'yellow'</span>, <span class="string">'red'</span>, <span class="string">'white'</span>],</span><br><span class="line">	<span class="string">'object'</span>: [<span class="string">'ball'</span>, <span class="string">'pen'</span>, <span class="string">'pencil'</span>, <span class="string">'paper'</span>, <span class="string">'mug'</span>],</span><br><span class="line">	<span class="string">'price'</span>: [<span class="number">1.2</span>, <span class="number">1.0</span>, <span class="number">0.5</span>, <span class="number">0.8</span>, <span class="number">1.5</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line">print(df[[<span class="string">"object"</span>, <span class="string">"price"</span>]])</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">   object  price</span><br><span class="line"><span class="number">0</span>    ball    <span class="number">1.2</span></span><br><span class="line"><span class="number">1</span>     pen    <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>  pencil    <span class="number">0.5</span></span><br><span class="line"><span class="number">3</span>   paper    <span class="number">0.8</span></span><br><span class="line"><span class="number">4</span>     mug    <span class="number">1.5</span></span><br></pre></td></tr></table></figure>
<h4 id="1-2-2-3-选择行"><a href="#1-2-2-3-选择行" class="headerlink" title="1.2.2.3. 选择行"></a>1.2.2.3. 选择行</h4><p>使用索引选择对应行的记录。其中 loc[] 中接受的可以是一个索引值，也可以是一个索引数组。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">myDict = &#123;</span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'blue'</span>, <span class="string">'green'</span>, <span class="string">'yellow'</span>, <span class="string">'red'</span>, <span class="string">'white'</span>],</span><br><span class="line">	<span class="string">'object'</span>: [<span class="string">'ball'</span>, <span class="string">'pen'</span>, <span class="string">'pencil'</span>, <span class="string">'paper'</span>, <span class="string">'mug'</span>],</span><br><span class="line">	<span class="string">'price'</span>: [<span class="number">1.2</span>, <span class="number">1.0</span>, <span class="number">0.5</span>, <span class="number">0.8</span>, <span class="number">1.5</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line">print(df.loc[<span class="number">2</span>])</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">color     yellow</span><br><span class="line">object    pencil</span><br><span class="line">price        <span class="number">0.5</span></span><br><span class="line">Name: <span class="number">2</span>, dtype: object</span><br></pre></td></tr></table></figure>
<h4 id="1-2-2-4-切片"><a href="#1-2-2-4-切片" class="headerlink" title="1.2.2.4. 切片"></a>1.2.2.4. 切片</h4><p>DataFrame 也支持切片，不过只支持行切片。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">myDict = &#123;</span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'blue'</span>, <span class="string">'green'</span>, <span class="string">'yellow'</span>, <span class="string">'red'</span>, <span class="string">'white'</span>],</span><br><span class="line">	<span class="string">'object'</span>: [<span class="string">'ball'</span>, <span class="string">'pen'</span>, <span class="string">'pencil'</span>, <span class="string">'paper'</span>, <span class="string">'mug'</span>],</span><br><span class="line">	<span class="string">'price'</span>: [<span class="number">1.2</span>, <span class="number">1.0</span>, <span class="number">0.5</span>, <span class="number">0.8</span>, <span class="number">1.5</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line">print(df[<span class="number">1</span>:<span class="number">3</span>])</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    color  object  price</span><br><span class="line"><span class="number">1</span>   green     pen    <span class="number">1.0</span></span><br><span class="line"><span class="number">2</span>  yellow  pencil    <span class="number">0.5</span></span><br></pre></td></tr></table></figure>
<h4 id="1-2-2-5-过滤"><a href="#1-2-2-5-过滤" class="headerlink" title="1.2.2.5. 过滤"></a>1.2.2.5. 过滤</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">myDict = &#123;</span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'blue'</span>, <span class="string">'green'</span>, <span class="string">'yellow'</span>, <span class="string">'red'</span>, <span class="string">'white'</span>],</span><br><span class="line">	<span class="string">'object'</span>: [<span class="string">'ball'</span>, <span class="string">'pen'</span>, <span class="string">'pencil'</span>, <span class="string">'paper'</span>, <span class="string">'mug'</span>],</span><br><span class="line">	<span class="string">'price'</span>: [<span class="number">1.2</span>, <span class="number">1.0</span>, <span class="number">0.5</span>, <span class="number">0.8</span>, <span class="number">1.5</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line">print(df[df[<span class="string">'price'</span>] &gt; <span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   color object  price</span><br><span class="line"><span class="number">0</span>   blue   ball    <span class="number">1.2</span></span><br><span class="line"><span class="number">4</span>  white    mug    <span class="number">1.5</span></span><br></pre></td></tr></table></figure>
<h3 id="1-2-3-修改-DataFrame"><a href="#1-2-3-修改-DataFrame" class="headerlink" title="1.2.3. 修改 DataFrame"></a>1.2.3. 修改 DataFrame</h3><h4 id="1-2-3-1-增加新列"><a href="#1-2-3-1-增加新列" class="headerlink" title="1.2.3.1. 增加新列"></a>1.2.3.1. 增加新列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">myDict = &#123;</span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'blue'</span>, <span class="string">'green'</span>, <span class="string">'yellow'</span>, <span class="string">'red'</span>, <span class="string">'white'</span>],</span><br><span class="line">	<span class="string">'object'</span>: [<span class="string">'ball'</span>, <span class="string">'pen'</span>, <span class="string">'pencil'</span>, <span class="string">'paper'</span>, <span class="string">'mug'</span>],</span><br><span class="line">	<span class="string">'price'</span>: [<span class="number">1.2</span>, <span class="number">1.0</span>, <span class="number">0.5</span>, <span class="number">0.8</span>, <span class="number">1.5</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line">df[<span class="string">'new'</span>] = <span class="number">12</span></span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    color  object  price  new</span><br><span class="line"><span class="number">0</span>    blue    ball    <span class="number">1.2</span>   <span class="number">12</span></span><br><span class="line"><span class="number">1</span>   green     pen    <span class="number">1.0</span>   <span class="number">12</span></span><br><span class="line"><span class="number">2</span>  yellow  pencil    <span class="number">0.5</span>   <span class="number">12</span></span><br><span class="line"><span class="number">3</span>     red   paper    <span class="number">0.8</span>   <span class="number">12</span></span><br><span class="line"><span class="number">4</span>   white     mug    <span class="number">1.5</span>   <span class="number">12</span></span><br></pre></td></tr></table></figure>
<p>也可以使用一个数组作为新的列：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'new'</span>] = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    color  object  price  new</span><br><span class="line"><span class="number">0</span>    blue    ball    <span class="number">1.2</span>    <span class="number">3</span></span><br><span class="line"><span class="number">1</span>   green     pen    <span class="number">1.0</span>    <span class="number">4</span></span><br><span class="line"><span class="number">2</span>  yellow  pencil    <span class="number">0.5</span>    <span class="number">5</span></span><br><span class="line"><span class="number">3</span>     red   paper    <span class="number">0.8</span>    <span class="number">6</span></span><br><span class="line"><span class="number">4</span>   white     mug    <span class="number">1.5</span>    <span class="number">7</span></span><br></pre></td></tr></table></figure>
<p>这里的数组还可以换成 Series。</p>
<h4 id="1-2-3-2-删除新列"><a href="#1-2-3-2-删除新列" class="headerlink" title="1.2.3.2. 删除新列"></a>1.2.3.2. 删除新列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> df[<span class="string">'price'</span>]</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    color  object  new</span><br><span class="line"><span class="number">0</span>    blue    ball    <span class="number">3</span></span><br><span class="line"><span class="number">1</span>   green     pen    <span class="number">4</span></span><br><span class="line"><span class="number">2</span>  yellow  pencil    <span class="number">5</span></span><br><span class="line"><span class="number">3</span>     red   paper    <span class="number">6</span></span><br><span class="line"><span class="number">4</span>   white     mug    <span class="number">7</span></span><br></pre></td></tr></table></figure>
<h2 id="Index-Object"><a href="#Index-Object" class="headerlink" title="Index Object"></a>Index Object</h2><p>Index Object 是 Pandas 中表示索引的对象，在前面的 Series 和 DataFrame 中实际上已经接触过这个对象了。</p>
<p>一般不会涉及到这个对象的操作，知道有这么个东西即可。</p>
<h1 id="2-数据操作"><a href="#2-数据操作" class="headerlink" title="2. 数据操作"></a>2. 数据操作</h1><h2 id="2-1-Lambda-表达式"><a href="#2-1-Lambda-表达式" class="headerlink" title="2.1. Lambda 表达式"></a>2.1. Lambda 表达式</h2><p>首先创建一个三行四列的 DataFrame：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr = np.arange(<span class="number">12</span>).reshape((<span class="number">3</span>, <span class="number">4</span>)) ** <span class="number">2</span></span><br><span class="line">df = pd.DataFrame(arr)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    <span class="number">0</span>   <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span></span><br><span class="line"><span class="number">0</span>   <span class="number">0</span>   <span class="number">1</span>    <span class="number">4</span>    <span class="number">9</span></span><br><span class="line"><span class="number">1</span>  <span class="number">16</span>  <span class="number">25</span>   <span class="number">36</span>   <span class="number">49</span></span><br><span class="line"><span class="number">2</span>  <span class="number">64</span>  <span class="number">81</span>  <span class="number">100</span>  <span class="number">121</span></span><br></pre></td></tr></table></figure>
<p>然后利用 lambda 表达式对其中的每个元素开平方：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = df.apply(<span class="keyword">lambda</span> x: np.sqrt(x))</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">     <span class="number">0</span>    <span class="number">1</span>     <span class="number">2</span>     <span class="number">3</span></span><br><span class="line"><span class="number">0</span>  <span class="number">0.0</span>  <span class="number">1.0</span>   <span class="number">2.0</span>   <span class="number">3.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">4.0</span>  <span class="number">5.0</span>   <span class="number">6.0</span>   <span class="number">7.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">8.0</span>  <span class="number">9.0</span>  <span class="number">10.0</span>  <span class="number">11.0</span></span><br></pre></td></tr></table></figure>
<h2 id="2-2-统计信息"><a href="#2-2-统计信息" class="headerlink" title="2.2. 统计信息"></a>2.2. 统计信息</h2><p><strong>sum()</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr = np.arange(<span class="number">12</span>).reshape((<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">df = pd.DataFrame(arr, columns=[<span class="string">'colA'</span>,<span class="string">'colB'</span>, <span class="string">'colC'</span>, <span class="string">'colD'</span>])</span><br><span class="line">print(df.sum())</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">colA    <span class="number">12</span></span><br><span class="line">colB    <span class="number">15</span></span><br><span class="line">colC    <span class="number">18</span></span><br><span class="line">colD    <span class="number">21</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p><strong>mean()</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr = np.arange(<span class="number">12</span>).reshape((<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">df = pd.DataFrame(arr, columns=[<span class="string">'colA'</span>,<span class="string">'colB'</span>, <span class="string">'colC'</span>, <span class="string">'colD'</span>])</span><br><span class="line">print(df.mean())</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">colA    <span class="number">4.0</span></span><br><span class="line">colB    <span class="number">5.0</span></span><br><span class="line">colC    <span class="number">6.0</span></span><br><span class="line">colD    <span class="number">7.0</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p><strong>describe()</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr = np.arange(<span class="number">12</span>).reshape((<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">df = pd.DataFrame(arr, columns=[<span class="string">'colA'</span>,<span class="string">'colB'</span>, <span class="string">'colC'</span>, <span class="string">'colD'</span>])</span><br><span class="line">print(df.describe())</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">       colA  colB  colC  colD</span><br><span class="line">count   <span class="number">3.0</span>   <span class="number">3.0</span>   <span class="number">3.0</span>   <span class="number">3.0</span></span><br><span class="line">mean    <span class="number">4.0</span>   <span class="number">5.0</span>   <span class="number">6.0</span>   <span class="number">7.0</span></span><br><span class="line">std     <span class="number">4.0</span>   <span class="number">4.0</span>   <span class="number">4.0</span>   <span class="number">4.0</span></span><br><span class="line">min     <span class="number">0.0</span>   <span class="number">1.0</span>   <span class="number">2.0</span>   <span class="number">3.0</span></span><br><span class="line"><span class="number">25</span>%     <span class="number">2.0</span>   <span class="number">3.0</span>   <span class="number">4.0</span>   <span class="number">5.0</span></span><br><span class="line"><span class="number">50</span>%     <span class="number">4.0</span>   <span class="number">5.0</span>   <span class="number">6.0</span>   <span class="number">7.0</span></span><br><span class="line"><span class="number">75</span>%     <span class="number">6.0</span>   <span class="number">7.0</span>   <span class="number">8.0</span>   <span class="number">9.0</span></span><br><span class="line">max     <span class="number">8.0</span>   <span class="number">9.0</span>  <span class="number">10.0</span>  <span class="number">11.0</span></span><br></pre></td></tr></table></figure>
<h2 id="2-3-排序"><a href="#2-3-排序" class="headerlink" title="2.3. 排序"></a>2.3. 排序</h2><h3 id="2-3-1-Series"><a href="#2-3-1-Series" class="headerlink" title="2.3.1. Series"></a>2.3.1. Series</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ser = pd.Series([<span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">3</span>], index=[<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>,<span class="string">'four'</span>,<span class="string">'five'</span>])</span><br><span class="line">print(ser.sort_index())</span><br><span class="line"></span><br><span class="line">print(ser.sort_values())</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sort by index</span></span><br><span class="line">five     <span class="number">3</span></span><br><span class="line">four     <span class="number">8</span></span><br><span class="line">one      <span class="number">1</span></span><br><span class="line">three    <span class="number">2</span></span><br><span class="line">two      <span class="number">5</span></span><br><span class="line">dtype: int64</span><br><span class="line"></span><br><span class="line"><span class="comment"># sort by values</span></span><br><span class="line">one      <span class="number">1</span></span><br><span class="line">three    <span class="number">2</span></span><br><span class="line">five     <span class="number">3</span></span><br><span class="line">two      <span class="number">5</span></span><br><span class="line">four     <span class="number">8</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="2-3-2-DataFrame"><a href="#2-3-2-DataFrame" class="headerlink" title="2.3.2. DataFrame"></a>2.3.2. DataFrame</h3><p>根据 colA 列的值进行倒序排序。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr = np.arange(<span class="number">12</span>).reshape((<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">df = pd.DataFrame(arr, columns=[<span class="string">'colA'</span>,<span class="string">'colB'</span>, <span class="string">'colC'</span>, <span class="string">'colD'</span>])</span><br><span class="line">print(df.sort_values(by=[<span class="string">'colA'</span>], ascending=<span class="keyword">False</span>))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">   colA  colB  colC  colD</span><br><span class="line"><span class="number">2</span>     <span class="number">8</span>     <span class="number">9</span>    <span class="number">10</span>    <span class="number">11</span></span><br><span class="line"><span class="number">1</span>     <span class="number">4</span>     <span class="number">5</span>     <span class="number">6</span>     <span class="number">7</span></span><br><span class="line"><span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span>     <span class="number">2</span>     <span class="number">3</span></span><br></pre></td></tr></table></figure>
<h1 id="3-读写数据"><a href="#3-读写数据" class="headerlink" title="3. 读写数据"></a>3. 读写数据</h1><h2 id="3-1-CSV"><a href="#3-1-CSV" class="headerlink" title="3.1. CSV"></a>3.1. CSV</h2><p><strong>读取CSV</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">"./somefile.csv"</span>)</span><br></pre></td></tr></table></figure>
<p><strong>写入CSV</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.to_csv(<span class="string">"./somefile.csv"</span>)</span><br></pre></td></tr></table></figure>
<h1 id="4-数据分析"><a href="#4-数据分析" class="headerlink" title="4. 数据分析"></a>4. 数据分析</h1><h2 id="4-1-数据准备"><a href="#4-1-数据准备" class="headerlink" title="4.1. 数据准备"></a>4.1. 数据准备</h2><h3 id="4-1-1-Merging"><a href="#4-1-1-Merging" class="headerlink" title="4.1.1. Merging"></a>4.1.1. Merging</h3><p>根据键进行拼接，有点类似于 SQL 语句中的 join 连接操作。</p>
<h4 id="4-1-1-1-简单连接"><a href="#4-1-1-1-简单连接" class="headerlink" title="4.1.1.1. 简单连接"></a>4.1.1.1. 简单连接</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">myDict1 = &#123;</span><br><span class="line">	<span class="string">'id'</span>:[<span class="string">'ball'</span>,<span class="string">'pencil'</span>,<span class="string">'pen'</span>,<span class="string">'mug'</span>,<span class="string">'ashtray'</span>], </span><br><span class="line">	<span class="string">'price'</span>: [<span class="number">12.33</span>,<span class="number">11.44</span>,<span class="number">33.21</span>,<span class="number">13.23</span>,<span class="number">33.62</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myDict2 = &#123;</span><br><span class="line">	<span class="string">'id'</span>:[<span class="string">'pencil'</span>,<span class="string">'pencil'</span>,<span class="string">'ball'</span>,<span class="string">'pen'</span>],</span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'white'</span>,<span class="string">'red'</span>,<span class="string">'red'</span>,<span class="string">'black'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(myDict1)</span><br><span class="line">df2 = pd.DataFrame(myDict2)</span><br><span class="line"></span><br><span class="line">print(pd.merge(df1, df2))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">       id  price  color</span><br><span class="line">0    ball  12.33    red</span><br><span class="line">1  pencil  11.44  white</span><br><span class="line">2  pencil  11.44    red</span><br><span class="line">3     pen  33.21  black</span><br></pre></td></tr></table></figure>
<p>这两个 DataFrame 通过 ID 这一列进行连接。</p>
<h4 id="4-1-1-2-使用-on-指定-key-字段"><a href="#4-1-1-2-使用-on-指定-key-字段" class="headerlink" title="4.1.1.2. 使用 on 指定 key 字段"></a>4.1.1.2. 使用 on 指定 key 字段</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">myDict1 = &#123;</span><br><span class="line">	<span class="string">'id'</span>:[<span class="string">'ball'</span>,<span class="string">'pencil'</span>,<span class="string">'pen'</span>,<span class="string">'mug'</span>,<span class="string">'ashtray'</span>],</span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'white'</span>,<span class="string">'red'</span>,<span class="string">'red'</span>,<span class="string">'black'</span>,<span class="string">'green'</span>],</span><br><span class="line">	<span class="string">'brand'</span>: [<span class="string">'OMG'</span>,<span class="string">'ABC'</span>,<span class="string">'ABC'</span>,<span class="string">'POD'</span>,<span class="string">'POD'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myDict2 = &#123;</span><br><span class="line">	<span class="string">'id'</span>:[<span class="string">'pencil'</span>,<span class="string">'pencil'</span>,<span class="string">'ball'</span>,<span class="string">'pen'</span>],</span><br><span class="line">	<span class="string">'brand'</span>: [<span class="string">'OMG'</span>,<span class="string">'POD'</span>,<span class="string">'ABC'</span>,<span class="string">'POD'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(myDict1)</span><br><span class="line">df2 = pd.DataFrame(myDict2)</span><br><span class="line"></span><br><span class="line">print(pd.merge(df1, df2, on = <span class="string">'id'</span>))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">       id  color brand_x brand_y</span><br><span class="line"><span class="number">0</span>    ball  white     OMG     ABC</span><br><span class="line"><span class="number">1</span>  pencil    red     ABC     OMG</span><br><span class="line"><span class="number">2</span>  pencil    red     ABC     POD</span><br><span class="line"><span class="number">3</span>     pen    red     ABC     POD</span><br></pre></td></tr></table></figure>
<h4 id="4-1-1-3-指定不同字段连接"><a href="#4-1-1-3-指定不同字段连接" class="headerlink" title="4.1.1.3. 指定不同字段连接"></a>4.1.1.3. 指定不同字段连接</h4><p>以上几个实例中连接时是假设两个 DataFrame 作为 key 的字段的列名是相同的，很多时候可能会存在不同的情况，那么应该如何处理？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">myDict1 = &#123;</span><br><span class="line">	<span class="string">'id'</span>:[<span class="string">'ball'</span>,<span class="string">'pencil'</span>,<span class="string">'pen'</span>,<span class="string">'mug'</span>,<span class="string">'ashtray'</span>],</span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'white'</span>,<span class="string">'red'</span>,<span class="string">'red'</span>,<span class="string">'black'</span>,<span class="string">'green'</span>],</span><br><span class="line">	<span class="string">'brand'</span>: [<span class="string">'OMG'</span>,<span class="string">'ABC'</span>,<span class="string">'ABC'</span>,<span class="string">'POD'</span>,<span class="string">'POD'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myDict2 = &#123;</span><br><span class="line">	<span class="string">'sid'</span>:[<span class="string">'pencil'</span>,<span class="string">'pencil'</span>,<span class="string">'ball'</span>,<span class="string">'pen'</span>],</span><br><span class="line">	<span class="string">'brand'</span>: [<span class="string">'OMG'</span>,<span class="string">'POD'</span>,<span class="string">'ABC'</span>,<span class="string">'POD'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(myDict1)</span><br><span class="line">df2 = pd.DataFrame(myDict2)</span><br><span class="line"></span><br><span class="line">print(pd.merge(df1, df2, left_on = <span class="string">'id'</span>, right_on = <span class="string">'sid'</span>))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">       id  color brand_x brand_y</span><br><span class="line"><span class="number">0</span>    ball  white     OMG     ABC</span><br><span class="line"><span class="number">1</span>  pencil    red     ABC     OMG</span><br><span class="line"><span class="number">2</span>  pencil    red     ABC     POD</span><br><span class="line"><span class="number">3</span>     pen    red     ABC     POD</span><br></pre></td></tr></table></figure>
<h4 id="4-1-1-4-连接方式"><a href="#4-1-1-4-连接方式" class="headerlink" title="4.1.1.4. 连接方式"></a>4.1.1.4. 连接方式</h4><p>在 SQL 中进行表的连接时，有几种连接方式，包括 inner join, outer join, left join and right join. 在 Pandas 中默认是内连接，也可以通过指定参数采用不同的连接方式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">myDict1 = &#123;</span><br><span class="line">	<span class="string">'id'</span>:[<span class="string">'ball'</span>,<span class="string">'pencil'</span>,<span class="string">'pen'</span>,<span class="string">'mug'</span>,<span class="string">'ashtray'</span>],</span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'white'</span>,<span class="string">'red'</span>,<span class="string">'red'</span>,<span class="string">'black'</span>,<span class="string">'green'</span>],</span><br><span class="line">	<span class="string">'brand'</span>: [<span class="string">'OMG'</span>,<span class="string">'ABC'</span>,<span class="string">'ABC'</span>,<span class="string">'POD'</span>,<span class="string">'POD'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myDict2 = &#123;</span><br><span class="line">	<span class="string">'id'</span>:[<span class="string">'pencil'</span>,<span class="string">'pencil'</span>,<span class="string">'ball'</span>,<span class="string">'pen'</span>],</span><br><span class="line">	<span class="string">'brand'</span>: [<span class="string">'OMG'</span>,<span class="string">'POD'</span>,<span class="string">'ABC'</span>,<span class="string">'POD'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(myDict1)</span><br><span class="line">df2 = pd.DataFrame(myDict2)</span><br><span class="line"></span><br><span class="line">print(pd.merge(df1, df2, on=<span class="string">'id'</span>))	<span class="comment"># 默认内连接</span></span><br><span class="line">print(pd.merge(df1, df2, on=<span class="string">'id'</span>, how=<span class="string">'outer'</span>))</span><br><span class="line">print(pd.merge(df1, df2, on=<span class="string">'id'</span>, how=<span class="string">'left'</span>))</span><br><span class="line">print(pd.merge(df1, df2, on=<span class="string">'id'</span>, how=<span class="string">'right'</span>))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 内连接：两边都有值的记录进行连接</span></span><br><span class="line">       id  color brand_x brand_y</span><br><span class="line"><span class="number">0</span>    ball  white     OMG     ABC</span><br><span class="line"><span class="number">1</span>  pencil    red     ABC     OMG</span><br><span class="line"><span class="number">2</span>  pencil    red     ABC     POD</span><br><span class="line"><span class="number">3</span>     pen    red     ABC     POD</span><br><span class="line"></span><br><span class="line"><span class="comment"># 外连接：将所有的记录都进行连接</span></span><br><span class="line">        id  color brand_x brand_y</span><br><span class="line"><span class="number">0</span>     ball  white     OMG     ABC</span><br><span class="line"><span class="number">1</span>   pencil    red     ABC     OMG</span><br><span class="line"><span class="number">2</span>   pencil    red     ABC     POD</span><br><span class="line"><span class="number">3</span>      pen    red     ABC     POD</span><br><span class="line"><span class="number">4</span>      mug  black     POD     NaN</span><br><span class="line"><span class="number">5</span>  ashtray  green     POD     NaN</span><br><span class="line"></span><br><span class="line"><span class="comment"># 左连接：以第一张表为主进行连接</span></span><br><span class="line">        id  color brand_x brand_y</span><br><span class="line"><span class="number">0</span>     ball  white     OMG     ABC</span><br><span class="line"><span class="number">1</span>   pencil    red     ABC     OMG</span><br><span class="line"><span class="number">2</span>   pencil    red     ABC     POD</span><br><span class="line"><span class="number">3</span>      pen    red     ABC     POD</span><br><span class="line"><span class="number">4</span>      mug  black     POD     NaN</span><br><span class="line"><span class="number">5</span>  ashtray  green     POD     NaN</span><br><span class="line"></span><br><span class="line"><span class="comment"># 右连接：以第二张表为主进行连接</span></span><br><span class="line">       id  color brand_x brand_y</span><br><span class="line"><span class="number">0</span>    ball  white     OMG     ABC</span><br><span class="line"><span class="number">1</span>  pencil    red     ABC     OMG</span><br><span class="line"><span class="number">2</span>  pencil    red     ABC     POD</span><br><span class="line"><span class="number">3</span>     pen    red     ABC     POD</span><br></pre></td></tr></table></figure>
<h4 id="4-1-1-5-基于索引连接"><a href="#4-1-1-5-基于索引连接" class="headerlink" title="4.1.1.5. 基于索引连接"></a>4.1.1.5. 基于索引连接</h4><p>Pandas 还提供了一个 <code>join()</code> 方法，用于基于索引的连接。</p>
<h3 id="4-1-2-Concatenating"><a href="#4-1-2-Concatenating" class="headerlink" title="4.1.2. Concatenating"></a>4.1.2. Concatenating</h3><p>将多个表拼接成一张表。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(np.random.rand(<span class="number">9</span>).reshape(<span class="number">3</span>,<span class="number">3</span>), index=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], columns=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>])</span><br><span class="line">df2 = pd.DataFrame(np.random.rand(<span class="number">9</span>).reshape(<span class="number">3</span>,<span class="number">3</span>), index=[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], columns=[<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>])</span><br><span class="line"></span><br><span class="line">print(pd.concat([df1, df2]))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">          A         B         C</span><br><span class="line"><span class="number">1</span>  <span class="number">0.110074</span>  <span class="number">0.360846</span>  <span class="number">0.817533</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0.464365</span>  <span class="number">0.804425</span>  <span class="number">0.372668</span></span><br><span class="line"><span class="number">3</span>  <span class="number">0.288729</span>  <span class="number">0.783474</span>  <span class="number">0.649644</span></span><br><span class="line"><span class="number">4</span>  <span class="number">0.941699</span>  <span class="number">0.804263</span>  <span class="number">0.493243</span></span><br><span class="line"><span class="number">5</span>  <span class="number">0.292398</span>  <span class="number">0.573224</span>  <span class="number">0.307815</span></span><br><span class="line"><span class="number">6</span>  <span class="number">0.447318</span>  <span class="number">0.134989</span>  <span class="number">0.667292</span></span><br></pre></td></tr></table></figure>
<h3 id="4-1-3-Combining"><a href="#4-1-3-Combining" class="headerlink" title="4.1.3. Combining"></a>4.1.3. Combining</h3><p>如果碰到需要合并的两个 DataFrame 中有重复的索引存在，而又不希望被第二个 DataFrame 覆盖相同索引的记录时，可以使用这个方法合并。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ser1 = pd.Series(np.random.rand(<span class="number">5</span>),index=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line">ser2 = pd.Series(np.random.rand(<span class="number">4</span>),index=[<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>])</span><br><span class="line"></span><br><span class="line">print(ser1)</span><br><span class="line">print(ser2)</span><br><span class="line">print(ser1.combine_first(ser2))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>    <span class="number">0.515438</span></span><br><span class="line"><span class="number">2</span>    <span class="number">0.371625</span></span><br><span class="line"><span class="number">3</span>    <span class="number">0.927717</span></span><br><span class="line"><span class="number">4</span>    <span class="number">0.321709</span></span><br><span class="line"><span class="number">5</span>    <span class="number">0.813122</span></span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>    <span class="number">0.564350</span></span><br><span class="line"><span class="number">4</span>    <span class="number">0.718179</span></span><br><span class="line"><span class="number">5</span>    <span class="number">0.741726</span></span><br><span class="line"><span class="number">6</span>    <span class="number">0.108383</span></span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>    <span class="number">0.515438</span></span><br><span class="line"><span class="number">2</span>    <span class="number">0.371625</span></span><br><span class="line"><span class="number">3</span>    <span class="number">0.927717</span></span><br><span class="line"><span class="number">4</span>    <span class="number">0.321709</span></span><br><span class="line"><span class="number">5</span>    <span class="number">0.813122</span></span><br><span class="line"><span class="number">6</span>    <span class="number">0.108383</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<h3 id="4-1-3-行转列"><a href="#4-1-3-行转列" class="headerlink" title="4.1.3. 行转列"></a>4.1.3. 行转列</h3><p>在处理独热编码时，会碰到这样的需求，直接看例子。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">myDict = &#123; </span><br><span class="line">	<span class="string">'color'</span>:[<span class="string">'white'</span>,<span class="string">'white'</span>,<span class="string">'white'</span>, <span class="string">'red'</span>,<span class="string">'red'</span>,<span class="string">'red'</span>, <span class="string">'black'</span>,<span class="string">'black'</span>,<span class="string">'black'</span>],</span><br><span class="line">	<span class="string">'item'</span>:[<span class="string">'ball'</span>,<span class="string">'pen'</span>,<span class="string">'mug'</span>, <span class="string">'ball'</span>,<span class="string">'pen'</span>,<span class="string">'mug'</span>, <span class="string">'ball'</span>,<span class="string">'pen'</span>,<span class="string">'mug'</span>],</span><br><span class="line">	<span class="string">'value'</span>: np.random.rand(<span class="number">9</span>)</span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">pdf = df.pivot(<span class="string">'color'</span>, <span class="string">'item'</span>)</span><br><span class="line">print(pdf)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">   color  item     value</span><br><span class="line"><span class="number">0</span>  white  ball  <span class="number">0.583582</span></span><br><span class="line"><span class="number">1</span>  white   pen  <span class="number">0.413616</span></span><br><span class="line"><span class="number">2</span>  white   mug  <span class="number">0.389276</span></span><br><span class="line"><span class="number">3</span>    red  ball  <span class="number">0.541863</span></span><br><span class="line"><span class="number">4</span>    red   pen  <span class="number">0.413578</span></span><br><span class="line"><span class="number">5</span>    red   mug  <span class="number">0.942618</span></span><br><span class="line"><span class="number">6</span>  black  ball  <span class="number">0.850345</span></span><br><span class="line"><span class="number">7</span>  black   pen  <span class="number">0.230536</span></span><br><span class="line"><span class="number">8</span>  black   mug  <span class="number">0.612583</span></span><br><span class="line"></span><br><span class="line">          value                    </span><br><span class="line">item       ball       mug       pen</span><br><span class="line">color                              </span><br><span class="line">black  <span class="number">0.850345</span>  <span class="number">0.612583</span>  <span class="number">0.230536</span></span><br><span class="line">red    <span class="number">0.541863</span>  <span class="number">0.942618</span>  <span class="number">0.413578</span></span><br><span class="line">white  <span class="number">0.583582</span>  <span class="number">0.389276</span>  <span class="number">0.413616</span></span><br></pre></td></tr></table></figure>
<h2 id="4-2-数据转换"><a href="#4-2-数据转换" class="headerlink" title="4.2. 数据转换"></a>4.2. 数据转换</h2><h3 id="4-2-1-去重"><a href="#4-2-1-去重" class="headerlink" title="4.2.1. 去重"></a>4.2.1. 去重</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">myDict = &#123; </span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'white'</span>,<span class="string">'white'</span>,<span class="string">'red'</span>,<span class="string">'red'</span>,<span class="string">'white'</span>],</span><br><span class="line">	<span class="string">'value'</span>: [<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line">print(df.duplicated())</span><br><span class="line"></span><br><span class="line">print(df[df.duplicated()])</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">1</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">2</span>    <span class="keyword">False</span></span><br><span class="line"><span class="number">3</span>     <span class="keyword">True</span></span><br><span class="line"><span class="number">4</span>     <span class="keyword">True</span></span><br><span class="line">dtype: bool</span><br><span class="line"></span><br><span class="line">   color  value</span><br><span class="line"><span class="number">3</span>    red      <span class="number">3</span></span><br><span class="line"><span class="number">4</span>  white      <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>这里需要注意的是，False 表示没有重复，那么后面打印出来的两个就是重复的值，而不是去重后的结果。</p>
<h3 id="4-2-2-map"><a href="#4-2-2-map" class="headerlink" title="4.2.2. map"></a>4.2.2. map</h3><p>map 或者说是字典，利用字典可以进行数据替换、添加等操作。</p>
<h4 id="4-2-2-1-基于-map-的替换"><a href="#4-2-2-1-基于-map-的替换" class="headerlink" title="4.2.2.1. 基于 map 的替换"></a>4.2.2.1. 基于 map 的替换</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">myDict = &#123; </span><br><span class="line">	<span class="string">'item'</span>:[<span class="string">'ball'</span>,<span class="string">'mug'</span>,<span class="string">'pen'</span>,<span class="string">'pencil'</span>,<span class="string">'ashtray'</span>],</span><br><span class="line">	<span class="string">'color'</span>:[<span class="string">'white'</span>,<span class="string">'rosso'</span>,<span class="string">'verde'</span>,<span class="string">'black'</span>,<span class="string">'yellow'</span>],</span><br><span class="line">	<span class="string">'price'</span>:[<span class="number">5.56</span>,<span class="number">4.20</span>,<span class="number">1.30</span>,<span class="number">0.56</span>,<span class="number">2.75</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line"></span><br><span class="line">newColor = &#123;</span><br><span class="line">	<span class="string">'rosso'</span>: <span class="string">'red'</span>,</span><br><span class="line">	<span class="string">'verde'</span>: <span class="string">'green'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">print(df.replace(newColor))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">      item   color  price</span><br><span class="line"><span class="number">0</span>     ball   white   <span class="number">5.56</span></span><br><span class="line"><span class="number">1</span>      mug   rosso   <span class="number">4.20</span></span><br><span class="line"><span class="number">2</span>      pen   verde   <span class="number">1.30</span></span><br><span class="line"><span class="number">3</span>   pencil   black   <span class="number">0.56</span></span><br><span class="line"><span class="number">4</span>  ashtray  yellow   <span class="number">2.75</span></span><br><span class="line"></span><br><span class="line">      item   color  price</span><br><span class="line"><span class="number">0</span>     ball   white   <span class="number">5.56</span></span><br><span class="line"><span class="number">1</span>      mug     red   <span class="number">4.20</span></span><br><span class="line"><span class="number">2</span>      pen   green   <span class="number">1.30</span></span><br><span class="line"><span class="number">3</span>   pencil   black   <span class="number">0.56</span></span><br><span class="line"><span class="number">4</span>  ashtray  yellow   <span class="number">2.75</span></span><br></pre></td></tr></table></figure>
<h4 id="4-2-2-2-基于-map-的添加操作"><a href="#4-2-2-2-基于-map-的添加操作" class="headerlink" title="4.2.2.2. 基于 map 的添加操作"></a>4.2.2.2. 基于 map 的添加操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">myDict = &#123; </span><br><span class="line">	<span class="string">'item'</span>:[<span class="string">'ball'</span>,<span class="string">'mug'</span>,<span class="string">'pen'</span>,<span class="string">'pencil'</span>,<span class="string">'ashtray'</span>],</span><br><span class="line">	<span class="string">'color'</span>:[<span class="string">'white'</span>,<span class="string">'rosso'</span>,<span class="string">'verde'</span>,<span class="string">'black'</span>,<span class="string">'yellow'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line"></span><br><span class="line">prices = &#123;</span><br><span class="line">	<span class="string">'ball'</span> : <span class="number">5.56</span>,</span><br><span class="line">	<span class="string">'mug'</span> : <span class="number">4.20</span>,</span><br><span class="line">	<span class="string">'bottle'</span> : <span class="number">1.30</span>,</span><br><span class="line">	<span class="string">'scissors'</span> : <span class="number">3.41</span>,</span><br><span class="line">	<span class="string">'pen'</span> : <span class="number">1.30</span>,</span><br><span class="line">	<span class="string">'pencil'</span> : <span class="number">0.56</span>,</span><br><span class="line">	<span class="string">'ashtray'</span> : <span class="number">2.75</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">df[<span class="string">'price'</span>] = df[<span class="string">'item'</span>].map(prices)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">      item   color</span><br><span class="line"><span class="number">0</span>     ball   white</span><br><span class="line"><span class="number">1</span>      mug   rosso</span><br><span class="line"><span class="number">2</span>      pen   verde</span><br><span class="line"><span class="number">3</span>   pencil   black</span><br><span class="line"><span class="number">4</span>  ashtray  yellow</span><br><span class="line"></span><br><span class="line">      item   color  price</span><br><span class="line"><span class="number">0</span>     ball   white   <span class="number">5.56</span></span><br><span class="line"><span class="number">1</span>      mug   rosso   <span class="number">4.20</span></span><br><span class="line"><span class="number">2</span>      pen   verde   <span class="number">1.30</span></span><br><span class="line"><span class="number">3</span>   pencil   black   <span class="number">0.56</span></span><br><span class="line"><span class="number">4</span>  ashtray  yellow   <span class="number">2.75</span></span><br></pre></td></tr></table></figure>
<h3 id="4-2-3-离散化"><a href="#4-2-3-离散化" class="headerlink" title="4.2.3. 离散化"></a>4.2.3. 离散化</h3><p>有时候在处理一个连续型值的列时，需要将值划分成几个区间，然后转换成离散型变量。</p>
<h4 id="4-2-3-1-指定区间切分"><a href="#4-2-3-1-指定区间切分" class="headerlink" title="4.2.3.1. 指定区间切分"></a>4.2.3.1. 指定区间切分</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">results = [<span class="number">12</span>, <span class="number">34</span>, <span class="number">67</span>, <span class="number">55</span>, <span class="number">28</span>, <span class="number">90</span>, <span class="number">99</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">56</span>, <span class="number">74</span>, <span class="number">44</span>, <span class="number">87</span>, <span class="number">23</span>, <span class="number">49</span>, <span class="number">89</span>, <span class="number">87</span>]</span><br><span class="line">bins = [<span class="number">0</span>, <span class="number">25</span>, <span class="number">50</span>, <span class="number">75</span>, <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line">cat = pd.cut(results, bins)</span><br><span class="line"></span><br><span class="line">print(cat)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[(<span class="number">0</span>, <span class="number">25</span>], (<span class="number">25</span>, <span class="number">50</span>], (<span class="number">50</span>, <span class="number">75</span>], (<span class="number">50</span>, <span class="number">75</span>], (<span class="number">25</span>, <span class="number">50</span>], ..., (<span class="number">75</span>, <span class="number">100</span>], (<span class="number">0</span>, <span class="number">25</span>], (<span class="number">25</span>, <span class="number">50</span>], (<span class="number">75</span>, <span class="number">100</span>], (<span class="number">75</span>, <span class="number">100</span>]]</span><br><span class="line">Length: <span class="number">17</span></span><br><span class="line">Categories (<span class="number">4</span>, interval[int64]): [(<span class="number">0</span>, <span class="number">25</span>] &lt; (<span class="number">25</span>, <span class="number">50</span>] &lt; (<span class="number">50</span>, <span class="number">75</span>] &lt; (<span class="number">75</span>, <span class="number">100</span>]]</span><br></pre></td></tr></table></figure>
<p>这里有三行结果，分别来看每行的含义：</p>
<ul>
<li>第一行是转换后的结果，即每个值被划分到哪个区间，这里就被替换成这个区间了</li>
<li>第二行是总数，即处理的数据的条数</li>
<li>第三行是划分的区间，这里一共被划分成四个区间</li>
</ul>
<p>查看所划分的分类：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(cat.categories)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IntervalIndex([(<span class="number">0</span>, <span class="number">25</span>], (<span class="number">25</span>, <span class="number">50</span>], (<span class="number">50</span>, <span class="number">75</span>], (<span class="number">75</span>, <span class="number">100</span>]]</span><br><span class="line">              closed=<span class="string">'right'</span>,</span><br><span class="line">              dtype=<span class="string">'interval[int64]'</span>)</span><br></pre></td></tr></table></figure>
<p>查看划分结果对应区间的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(cat.codes)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">1</span> <span class="number">3</span> <span class="number">3</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2</span> <span class="number">2</span> <span class="number">1</span> <span class="number">3</span> <span class="number">0</span> <span class="number">1</span> <span class="number">3</span> <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<p>统计划分后的结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(pd.value_counts(cat))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">75</span>, <span class="number">100</span>]    <span class="number">5</span></span><br><span class="line">(<span class="number">50</span>, <span class="number">75</span>]     <span class="number">4</span></span><br><span class="line">(<span class="number">25</span>, <span class="number">50</span>]     <span class="number">4</span></span><br><span class="line">(<span class="number">0</span>, <span class="number">25</span>]      <span class="number">4</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>可以对区间设置名称：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">results = [<span class="number">12</span>, <span class="number">34</span>, <span class="number">67</span>, <span class="number">55</span>, <span class="number">28</span>, <span class="number">90</span>, <span class="number">99</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">56</span>, <span class="number">74</span>, <span class="number">44</span>, <span class="number">87</span>, <span class="number">23</span>, <span class="number">49</span>, <span class="number">89</span>, <span class="number">87</span>]</span><br><span class="line">bins = [<span class="number">0</span>, <span class="number">25</span>, <span class="number">50</span>, <span class="number">75</span>, <span class="number">100</span>]</span><br><span class="line">bin_names = [<span class="string">'unlikely'</span>,<span class="string">'less likely'</span>,<span class="string">'likely'</span>,<span class="string">'highly likely'</span>]</span><br><span class="line"></span><br><span class="line">cat = pd.cut(results, bins, labels = bin_names)</span><br><span class="line"></span><br><span class="line">print(cat)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[unlikely, less likely, likely, likely, less likely, ..., highly likely, unlikely, less likely, highly likely, highly likely]</span><br><span class="line">Length: <span class="number">17</span></span><br><span class="line">Categories (<span class="number">4</span>, object): [unlikely &lt; less likely &lt; likely &lt; highly likely]</span><br></pre></td></tr></table></figure>
<h4 id="4-2-3-2-指定区间数量等距切分"><a href="#4-2-3-2-指定区间数量等距切分" class="headerlink" title="4.2.3.2. 指定区间数量等距切分"></a>4.2.3.2. 指定区间数量等距切分</h4><p>根据指定区间的数量，以及该列值的最大值和最小值，切割成若干等分，然后进行划分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">results = [<span class="number">12</span>, <span class="number">34</span>, <span class="number">67</span>, <span class="number">55</span>, <span class="number">28</span>, <span class="number">90</span>, <span class="number">99</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">56</span>, <span class="number">74</span>, <span class="number">44</span>, <span class="number">87</span>, <span class="number">23</span>, <span class="number">49</span>, <span class="number">89</span>, <span class="number">87</span>]</span><br><span class="line">bin_names = [<span class="string">'unlikely'</span>,<span class="string">'less likely'</span>,<span class="string">'likely'</span>,<span class="string">'highly likely'</span>]</span><br><span class="line"></span><br><span class="line">cat = pd.cut(results, <span class="number">4</span>, labels = bin_names)</span><br><span class="line"></span><br><span class="line">print(cat)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[unlikely, less likely, likely, likely, less likely, ..., highly likely, unlikely, less likely, highly likely, highly likely]</span><br><span class="line">Length: <span class="number">17</span></span><br><span class="line">Categories (<span class="number">4</span>, object): [unlikely &lt; less likely &lt; likely &lt; highly likely]</span><br></pre></td></tr></table></figure>
<h4 id="4-2-3-3-指定区间数量根据密度划分"><a href="#4-2-3-3-指定区间数量根据密度划分" class="headerlink" title="4.2.3.3. 指定区间数量根据密度划分"></a>4.2.3.3. 指定区间数量根据密度划分</h4><p>指定区间数量，根据数据散布的特点，确保每个区间最终划分的值的数量相同，至于区间边界，不一定是等分的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">results = [<span class="number">12</span>, <span class="number">34</span>, <span class="number">67</span>, <span class="number">55</span>, <span class="number">28</span>, <span class="number">90</span>, <span class="number">99</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">56</span>, <span class="number">74</span>, <span class="number">44</span>, <span class="number">87</span>, <span class="number">23</span>, <span class="number">49</span>, <span class="number">89</span>, <span class="number">87</span>, <span class="number">20</span>]</span><br><span class="line">bin_names = [<span class="string">'unlikely'</span>,<span class="string">'likely'</span>,<span class="string">'highly likely'</span>]</span><br><span class="line"></span><br><span class="line">cat1 = pd.cut(results, <span class="number">3</span>, labels = bin_names)</span><br><span class="line">cat2 = pd.qcut(results, <span class="number">3</span>, labels = bin_names)</span><br><span class="line"></span><br><span class="line">print(pd.value_counts(cat1))</span><br><span class="line">print(pd.value_counts(cat2))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pd.cut()</span></span><br><span class="line">unlikely         <span class="number">7</span></span><br><span class="line">highly likely    <span class="number">6</span></span><br><span class="line">likely           <span class="number">5</span></span><br><span class="line">dtype: int64</span><br><span class="line"></span><br><span class="line"><span class="comment"># pd.qcut()</span></span><br><span class="line">highly likely    <span class="number">6</span></span><br><span class="line">likely           <span class="number">6</span></span><br><span class="line">unlikely         <span class="number">6</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="4-2-4-随机采样"><a href="#4-2-4-随机采样" class="headerlink" title="4.2.4. 随机采样"></a>4.2.4. 随机采样</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">myDict = &#123; </span><br><span class="line">	<span class="string">'item'</span>:[<span class="string">'ball'</span>,<span class="string">'mug'</span>,<span class="string">'pen'</span>,<span class="string">'pencil'</span>,<span class="string">'ashtray'</span>],</span><br><span class="line">	<span class="string">'color'</span>:[<span class="string">'white'</span>,<span class="string">'rosso'</span>,<span class="string">'verde'</span>,<span class="string">'black'</span>,<span class="string">'yellow'</span>],</span><br><span class="line">	<span class="string">'price'</span>:[<span class="number">5.56</span>,<span class="number">4.20</span>,<span class="number">1.30</span>,<span class="number">0.56</span>,<span class="number">2.75</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line">sample = np.random.randint(<span class="number">0</span>, len(df), size=<span class="number">3</span>)</span><br><span class="line">print(df.take(sample))</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">     item  color  price</span><br><span class="line"><span class="number">2</span>     pen  verde   <span class="number">1.30</span></span><br><span class="line"><span class="number">0</span>    ball  white   <span class="number">5.56</span></span><br><span class="line"><span class="number">3</span>  pencil  black   <span class="number">0.56</span></span><br></pre></td></tr></table></figure>
<h2 id="4-3-数据聚合"><a href="#4-3-数据聚合" class="headerlink" title="4.3. 数据聚合"></a>4.3. 数据聚合</h2><p>数据聚合是数据分析中很重要的一部分内容，比如常见的求和、求平均等都是属于聚合。聚合中很重要的一部分就是分组处理。</p>
<p>我们可以把分组处理拆分为三个阶段：</p>
<ul>
<li>拆分 —— 将数据集拆分成不同的分组</li>
<li>处理 —— 对每个分组分别进行处理</li>
<li>合并 —— 将每个分组处理的结果合并成最终的结果</li>
</ul>
<p>给定一个 DataFrame：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">myDict = &#123; </span><br><span class="line">	<span class="string">'color'</span>: [<span class="string">'white'</span>,<span class="string">'red'</span>,<span class="string">'green'</span>,<span class="string">'red'</span>,<span class="string">'green'</span>],</span><br><span class="line">	<span class="string">'object'</span>: [<span class="string">'pen'</span>,<span class="string">'pencil'</span>,<span class="string">'pencil'</span>,<span class="string">'ashtray'</span>,<span class="string">'pen'</span>],</span><br><span class="line">	<span class="string">'price1'</span>: [<span class="number">5.56</span>,<span class="number">4.20</span>,<span class="number">1.30</span>,<span class="number">0.56</span>,<span class="number">2.75</span>],</span><br><span class="line">	<span class="string">'price2'</span>: [<span class="number">4.75</span>,<span class="number">4.12</span>,<span class="number">1.60</span>,<span class="number">0.75</span>,<span class="number">3.15</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(myDict)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">   color   object  price1  price2</span><br><span class="line"><span class="number">0</span>  white      pen    <span class="number">5.56</span>    <span class="number">4.75</span></span><br><span class="line"><span class="number">1</span>    red   pencil    <span class="number">4.20</span>    <span class="number">4.12</span></span><br><span class="line"><span class="number">2</span>  green   pencil    <span class="number">1.30</span>    <span class="number">1.60</span></span><br><span class="line"><span class="number">3</span>    red  ashtray    <span class="number">0.56</span>    <span class="number">0.75</span></span><br><span class="line"><span class="number">4</span>  green      pen    <span class="number">2.75</span>    <span class="number">3.15</span></span><br></pre></td></tr></table></figure>
<p>现在要求按照颜色一列统计价格1的平均值。</p>
<p>首先按照颜色进行分组：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">group = df[<span class="string">'price1'</span>].groupby(df[<span class="string">'color'</span>])</span><br><span class="line">print(group.groups)</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">'green'</span>: Int64Index([<span class="number">2</span>, <span class="number">4</span>], dtype=<span class="string">'int64'</span>), </span><br><span class="line">	<span class="string">'red'</span>: Int64Index([<span class="number">1</span>, <span class="number">3</span>], dtype=<span class="string">'int64'</span>), </span><br><span class="line">	<span class="string">'white'</span>: Int64Index([<span class="number">0</span>], dtype=<span class="string">'int64'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后计算每组的平均值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(group.mean())</span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">color</span><br><span class="line">green    <span class="number">2.025</span></span><br><span class="line">red      <span class="number">2.380</span></span><br><span class="line">white    <span class="number">5.560</span></span><br><span class="line">Name: price1, dtype: float64</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/29/Pandas-Tutorial/" data-id="cjp2r2a0o006m0wluu46bi84k" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Data-Analysis/">Data Analysis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DataFrame/">DataFrame</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Pandas/">Pandas</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Series/">Series</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2018/11/29/Numpy-Tutorial/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Numpy Tutorial</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<div id="vcomment"></div>
<script>
	window.onload=function(){
		var valine = new Valine();
	    valine.init({
	        el:'#vcomment',
	        visitor: true,
	        appId: 'vnzbDotbVyiabKcguwfQoQdU-gzGzoHsz',
	        appKey: 'c3TWlvkfKgsN0dcLC7ftudvf'
	    })
	}
</script>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/">Hadoop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Idea/">Idea</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/KVM/">KVM</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MachineLearning/">MachineLearning</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nodejs/">Nodejs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Scala/">Scala</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Scrapy/">Scrapy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spark/">Spark</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Windows/">Windows</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/kernel/">kernel</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/乱七八糟/">乱七八糟</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/饭团的小日子/">饭团的小日子</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2080ti/">2080ti</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Array/">Array</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Blog/">Blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bridge/">Bridge</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cross-Validation/">Cross Validation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DAG/">DAG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DIY/">DIY</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Analysis/">Data Analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Science/">Data Science</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-wrangling/">Data wrangling</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DataFrame/">DataFrame</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Driver/">Driver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Exector/">Exector</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Explorator-Analysis/">Explorator Analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Feature-Selection/">Feature Selection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GitHub/">GitHub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HBase/">HBase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/History-Server/">History-Server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Idea/">Idea</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/">JVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Job/">Job</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KVM/">KVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kaggle/">Kaggle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KickStart/">KickStart</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Log4J/">Log4J</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LogBack/">LogBack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MAT/">MAT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math-Function/">Math Function</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Matplotlib/">Matplotlib</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Maven/">Maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/">MongoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NVIDIA/">NVIDIA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Network/">Network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Network-Connection/">Network Connection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nodejs/">Nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numpy/">Numpy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PairRDD/">PairRDD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pandas/">Pandas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RDD/">RDD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Run-Main/">Run Main</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SKLearn/">SKLearn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SLF4J/">SLF4J</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSH/">SSH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sbt/">Sbt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scala/">Scala</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scala操作HBase/">Scala操作HBase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scrapy/">Scrapy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scrapyd-client/">Scrapyd-client</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scrapyd-deploy/">Scrapyd-deploy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Seaborn/">Seaborn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Series/">Series</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Slicing/">Slicing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark/">Spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark-on-Yarn/">Spark on Yarn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark-shell/">Spark-shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stage/">Stage</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Static-IP/">Static IP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Syntax/">Syntax</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Titanic/">Titanic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Visual-C/">Visual C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ZooKeeper/">ZooKeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/firewall/">firewall</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/">hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hdfs/">hdfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/my-ini/">my.ini</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nbd/">nbd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/">nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/open-vswitch/">open-vswitch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/port/">port</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sbt-package/">sbt package</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yarn/">yarn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/休眠/">休眠</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/免密登录/">免密登录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内存分析/">内存分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/命令行安装虚拟机/">命令行安装虚拟机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多线程/">多线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/容器/">容器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/无人值守/">无人值守</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/桥接/">桥接</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/烘干机/">烘干机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/爬虫/">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生产者消费者模式/">生产者消费者模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/端口/">端口</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络连接/">网络连接</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/跨主机/">跨主机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/防火墙/">防火墙</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/集群/">集群</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/2080ti/" style="font-size: 10px;">2080ti</a> <a href="/tags/Array/" style="font-size: 10px;">Array</a> <a href="/tags/Blog/" style="font-size: 10px;">Blog</a> <a href="/tags/Bridge/" style="font-size: 13.33px;">Bridge</a> <a href="/tags/Cross-Validation/" style="font-size: 10px;">Cross Validation</a> <a href="/tags/DAG/" style="font-size: 10px;">DAG</a> <a href="/tags/DIY/" style="font-size: 10px;">DIY</a> <a href="/tags/Data-Analysis/" style="font-size: 10px;">Data Analysis</a> <a href="/tags/Data-Science/" style="font-size: 10px;">Data Science</a> <a href="/tags/Data-wrangling/" style="font-size: 10px;">Data wrangling</a> <a href="/tags/DataFrame/" style="font-size: 10px;">DataFrame</a> <a href="/tags/Driver/" style="font-size: 10px;">Driver</a> <a href="/tags/Exector/" style="font-size: 10px;">Exector</a> <a href="/tags/Explorator-Analysis/" style="font-size: 10px;">Explorator Analysis</a> <a href="/tags/Feature-Selection/" style="font-size: 10px;">Feature Selection</a> <a href="/tags/GitHub/" style="font-size: 10px;">GitHub</a> <a href="/tags/HBase/" style="font-size: 16.67px;">HBase</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/History-Server/" style="font-size: 10px;">History-Server</a> <a href="/tags/Idea/" style="font-size: 13.33px;">Idea</a> <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/Job/" style="font-size: 10px;">Job</a> <a href="/tags/KVM/" style="font-size: 13.33px;">KVM</a> <a href="/tags/Kaggle/" style="font-size: 10px;">Kaggle</a> <a href="/tags/KickStart/" style="font-size: 10px;">KickStart</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Log4J/" style="font-size: 10px;">Log4J</a> <a href="/tags/LogBack/" style="font-size: 10px;">LogBack</a> <a href="/tags/MAT/" style="font-size: 10px;">MAT</a> <a href="/tags/Math-Function/" style="font-size: 10px;">Math Function</a> <a href="/tags/Matplotlib/" style="font-size: 10px;">Matplotlib</a> <a href="/tags/Maven/" style="font-size: 13.33px;">Maven</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/NVIDIA/" style="font-size: 10px;">NVIDIA</a> <a href="/tags/Network/" style="font-size: 10px;">Network</a> <a href="/tags/Network-Connection/" style="font-size: 10px;">Network Connection</a> <a href="/tags/Nodejs/" style="font-size: 10px;">Nodejs</a> <a href="/tags/Numpy/" style="font-size: 10px;">Numpy</a> <a href="/tags/PairRDD/" style="font-size: 10px;">PairRDD</a> <a href="/tags/Pandas/" style="font-size: 13.33px;">Pandas</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/RDD/" style="font-size: 10px;">RDD</a> <a href="/tags/Run-Main/" style="font-size: 10px;">Run Main</a> <a href="/tags/SKLearn/" style="font-size: 10px;">SKLearn</a> <a href="/tags/SLF4J/" style="font-size: 10px;">SLF4J</a> <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/Sbt/" style="font-size: 10px;">Sbt</a> <a href="/tags/Scala/" style="font-size: 20px;">Scala</a> <a href="/tags/Scala操作HBase/" style="font-size: 10px;">Scala操作HBase</a> <a href="/tags/Scrapy/" style="font-size: 10px;">Scrapy</a> <a href="/tags/Scrapyd-client/" style="font-size: 10px;">Scrapyd-client</a> <a href="/tags/Scrapyd-deploy/" style="font-size: 10px;">Scrapyd-deploy</a> <a href="/tags/Seaborn/" style="font-size: 10px;">Seaborn</a> <a href="/tags/Series/" style="font-size: 10px;">Series</a> <a href="/tags/Slicing/" style="font-size: 10px;">Slicing</a> <a href="/tags/Spark/" style="font-size: 16.67px;">Spark</a> <a href="/tags/Spark-on-Yarn/" style="font-size: 10px;">Spark on Yarn</a> <a href="/tags/Spark-shell/" style="font-size: 10px;">Spark-shell</a> <a href="/tags/Stage/" style="font-size: 10px;">Stage</a> <a href="/tags/Static-IP/" style="font-size: 10px;">Static IP</a> <a href="/tags/Syntax/" style="font-size: 10px;">Syntax</a> <a href="/tags/Titanic/" style="font-size: 10px;">Titanic</a> <a href="/tags/Visual-C/" style="font-size: 10px;">Visual C++</a> <a href="/tags/ZooKeeper/" style="font-size: 10px;">ZooKeeper</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/firewall/" style="font-size: 10px;">firewall</a> <a href="/tags/hadoop/" style="font-size: 10px;">hadoop</a> <a href="/tags/hdfs/" style="font-size: 10px;">hdfs</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/my-ini/" style="font-size: 10px;">my.ini</a> <a href="/tags/nbd/" style="font-size: 10px;">nbd</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/open-vswitch/" style="font-size: 10px;">open-vswitch</a> <a href="/tags/port/" style="font-size: 10px;">port</a> <a href="/tags/sbt-package/" style="font-size: 10px;">sbt package</a> <a href="/tags/yarn/" style="font-size: 10px;">yarn</a> <a href="/tags/休眠/" style="font-size: 10px;">休眠</a> <a href="/tags/免密登录/" style="font-size: 10px;">免密登录</a> <a href="/tags/内存分析/" style="font-size: 10px;">内存分析</a> <a href="/tags/命令行安装虚拟机/" style="font-size: 10px;">命令行安装虚拟机</a> <a href="/tags/多线程/" style="font-size: 10px;">多线程</a> <a href="/tags/容器/" style="font-size: 10px;">容器</a> <a href="/tags/无人值守/" style="font-size: 10px;">无人值守</a> <a href="/tags/桥接/" style="font-size: 10px;">桥接</a> <a href="/tags/烘干机/" style="font-size: 10px;">烘干机</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a> <a href="/tags/生产者消费者模式/" style="font-size: 10px;">生产者消费者模式</a> <a href="/tags/端口/" style="font-size: 10px;">端口</a> <a href="/tags/网络连接/" style="font-size: 10px;">网络连接</a> <a href="/tags/跨主机/" style="font-size: 10px;">跨主机</a> <a href="/tags/防火墙/" style="font-size: 10px;">防火墙</a> <a href="/tags/集群/" style="font-size: 13.33px;">集群</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/11/29/Pandas-Tutorial/">Pandas Tutorial</a>
          </li>
        
          <li>
            <a href="/2018/11/29/Numpy-Tutorial/">Numpy Tutorial</a>
          </li>
        
          <li>
            <a href="/2018/11/28/基于Kaggle的泰坦尼克生存预测介绍一种数据分析框架/">基于Kaggle的泰坦尼克生存预测介绍一种数据分析框架</a>
          </li>
        
          <li>
            <a href="/2018/11/22/基于生产者消费者模式实现数据从-MongoDB-导入-HBase/">基于生产者消费者模式实现数据从 MongoDB 导入 HBase</a>
          </li>
        
          <li>
            <a href="/2018/11/21/npm-install-Error-EACCES-permission-denied/">npm install Error EACCES permission denied</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 weilu<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="http://libs.baidu.com/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>